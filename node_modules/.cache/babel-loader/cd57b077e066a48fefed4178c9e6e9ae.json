{"ast":null,"code":"'use strict';import _classCallCheck from\"/Users/wan/smartplug/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/wan/smartplug/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/wan/smartplug/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/wan/smartplug/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/wan/smartplug/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import $ from'jquery';import logo from\"./logo.svg\";import'./App.css';//------------------------SPEECH RECOGNITION-----------------------------\nvar SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;var recognition=new SpeechRecognition();recognition.continous=true;recognition.interimResults=true;recognition.lang='zh-TW';//------------------------COMPONENT-----------------------------\nvar Speech=/*#__PURE__*/function(_Component){_inherits(Speech,_Component);var _super=_createSuper(Speech);function Speech(){var _this;_classCallCheck(this,Speech);_this=_super.call(this);_this.state={listening:false,bgcolor:'#282c34'};_this.toggleListen=_this.toggleListen.bind(_assertThisInitialized(_this));_this.handleListen=_this.handleListen.bind(_assertThisInitialized(_this));return _this;}_createClass(Speech,[{key:\"toggleListen\",value:function toggleListen(){this.setState({listening:!this.state.listening},this.handleListen);}},{key:\"handleListen\",value:function handleListen(){var _this2=this;console.log('listening?',this.state.listening);if(this.state.listening){recognition.start();recognition.onend=function(){console.log(\"...continue listening...\");recognition.start();};}else{recognition.stop();recognition.onend=function(){console.log(\"Stopped listening per click\");};}recognition.onstart=function(){console.log(\"Listening!\");_this2.setState({bgcolor:'#282c34'});};var intermiTranscript='';recognition.onresult=function(event){var finalTranscript='';for(var i=event.resultIndex;i<event.results.length;i++){var transcript=event.results[i][0].transcript;if(event.results[i].isFinal)intermiTranscript+=transcript+' ';else finalTranscript+=transcript;}console.log(finalTranscript);if(finalTranscript===\"開始煮飯\"){console.log(\"指令成功！\");_this2.setState({bgcolor:'#006400'});$.ajax({url:\"https://maker.ifttt.com/trigger/ricecookeron/with/key/dyMeTmyKz4_uQNNPyqZABx\",data:{\"value1\":\"rice cooker on\"},success:function success(result){alert(result);}});}else if(finalTranscript===\"關掉電源\"){console.log(\"指令成功！\");_this2.setState({bgcolor:'#006400'});$.ajax({url:\"https://maker.ifttt.com/trigger/ricecookeroff/with/key/dyMeTmyKz4_uQNNPyqZABx\",data:{\"value1\":\"rice cooker off\"},success:function success(result){alert(result);}});}document.getElementById('final').innerHTML=finalTranscript;//-------------------------COMMANDS------------------------------------\nvar transcriptArr=finalTranscript.split(' ');var stopCmd=transcriptArr.slice(-3,-1);console.log('stopCmd',stopCmd);if(stopCmd[0]==='stop'&&stopCmd[1]==='listening'){recognition.stop();recognition.onend=function(){console.log('Stopped listening per command');var finalText=transcriptArr.slice(0,-3).join(' ');document.getElementById('final').innerHTML=finalText;};}};//-----------------------------------------------------------------------\nrecognition.onerror=function(event){console.log(\"Error occurred in recognition: \"+event.error);};}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{style:container},/*#__PURE__*/React.createElement(\"header\",{className:\"App-header\",style:{backgroundColor:this.state.bgcolor}},/*#__PURE__*/React.createElement(\"button\",{id:\"microphone-btn\",style:button,onClick:this.toggleListen},/*#__PURE__*/React.createElement(\"img\",{src:logo,className:\"App-logo\",alt:\"logo\"})),/*#__PURE__*/React.createElement(\"div\",{id:\"final\",style:final})));}}]);return Speech;}(Component);export default Speech;//-------------------------CSS------------------------------------\nvar styles={container:{flexDirection:'column',alignItems:'center',textAlign:'center'},body:{background:'black'},button:{background:'transparent',borderWidth:0},final:{color:'white',borderWidth:0,padding:'1em',margin:'1em',width:'300px',textAlign:'center'}};var container=styles.container,button=styles.button,final=styles.final,body=styles.body;","map":{"version":3,"sources":["/Users/wan/smartplug/src/App.js"],"names":["React","Component","$","SpeechRecognition","window","webkitSpeechRecognition","recognition","continous","interimResults","lang","Speech","state","listening","bgcolor","toggleListen","bind","handleListen","setState","console","log","start","onend","stop","onstart","intermiTranscript","onresult","event","finalTranscript","i","resultIndex","results","length","transcript","isFinal","ajax","url","data","success","result","alert","document","getElementById","innerHTML","transcriptArr","split","stopCmd","slice","finalText","join","onerror","error","container","backgroundColor","button","logo","final","styles","flexDirection","alignItems","textAlign","body","background","borderWidth","color","padding","margin","width"],"mappings":"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","sourcesContent":["'use strict'\nimport React, { Component } from \"react\"\nimport $ from 'jquery';\nimport logo from './logo.svg';\nimport './App.css';\n\n\n//------------------------SPEECH RECOGNITION-----------------------------\n\nconst SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\nconst recognition = new SpeechRecognition()\n\nrecognition.continous = true\nrecognition.interimResults = true\nrecognition.lang = 'zh-TW'\n\n\n//------------------------COMPONENT-----------------------------\n\nclass Speech extends Component {\n\n  constructor() {\n    super()\n    this.state = {\n      listening: false,\n      bgcolor:'#282c34'\n    }\n    this.toggleListen = this.toggleListen.bind(this)\n    this.handleListen = this.handleListen.bind(this)\n  }\n\n  toggleListen() {\n    this.setState({\n      listening: !this.state.listening\n    }, this.handleListen)\n  }\n\n  handleListen() {\n\n    console.log('listening?', this.state.listening)\n\n    if (this.state.listening) {\n      recognition.start()\n      recognition.onend = () => {\n        console.log(\"...continue listening...\")\n        recognition.start()\n      }\n\n    } else {\n      recognition.stop()\n      recognition.onend = () => {\n        console.log(\"Stopped listening per click\")\n      }\n    }\n\n    recognition.onstart = () => {\n      console.log(\"Listening!\")\n      this.setState({\n        bgcolor:'#282c34'\n      })\n    }\n\n    let intermiTranscript = ''\n    recognition.onresult = event => {\n      let finalTranscript = ''\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        const transcript = event.results[i][0].transcript;\n        if (event.results[i].isFinal) intermiTranscript += transcript + ' ';\n        else finalTranscript += transcript;\n      }\n      console.log(finalTranscript)\n      if (finalTranscript === \"開始煮飯\"){\n        console.log(\"指令成功！\")\n        this.setState({\n          bgcolor:'#006400'\n        })\n        $.ajax({\n          url:\"https://maker.ifttt.com/trigger/ricecookeron/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          data: {\"value1\":\"rice cooker on\"},\n          success:function(result){alert(result)}\n        })\n      }\n      else if(finalTranscript === \"關掉電源\"){\n        console.log(\"指令成功！\")\n        this.setState({\n          bgcolor:'#006400'\n        })\n        $.ajax({\n          url:\"https://maker.ifttt.com/trigger/ricecookeroff/with/key/dyMeTmyKz4_uQNNPyqZABx\",\n          data: {\"value1\":\"rice cooker off\"},\n          success:function(result){alert(result)}\n        })\n      }\n      document.getElementById('final').innerHTML = finalTranscript\n\n      //-------------------------COMMANDS------------------------------------\n\n      const transcriptArr = finalTranscript.split(' ')\n      const stopCmd = transcriptArr.slice(-3, -1)\n      console.log('stopCmd', stopCmd)\n\n      if (stopCmd[0] === 'stop' && stopCmd[1] === 'listening'){\n        recognition.stop()\n        recognition.onend = () => {\n          console.log('Stopped listening per command')\n          const finalText = transcriptArr.slice(0, -3).join(' ')\n          document.getElementById('final').innerHTML = finalText\n        }\n      }\n    }\n\n    //-----------------------------------------------------------------------\n\n    recognition.onerror = event => {\n      console.log(\"Error occurred in recognition: \" + event.error)\n    }\n\n  }\n\n  render() {\n    return (\n        <div style={container}>\n          <header className=\"App-header\" style={{backgroundColor: this.state.bgcolor}}>\n            <button id='microphone-btn' style={button} onClick={this.toggleListen}>\n              <img src={logo} className=\"App-logo\" alt=\"logo\"/>\n            </button>\n            <div id='final' style={final}></div>\n          </header>\n        </div>\n    )\n  }\n}\n\nexport default Speech\n\n\n//-------------------------CSS------------------------------------\n\nconst styles = {\n  container: {\n    flexDirection: 'column',\n    alignItems: 'center',\n    textAlign: 'center'\n  },\n  body: {\n    background: 'black'\n  },\n  button: {\n    background: 'transparent',\n    borderWidth:0\n  },\n  final: {\n    color: 'white',\n    borderWidth:0,\n    padding: '1em',\n    margin: '1em',\n    width: '300px',\n    textAlign: 'center'\n  }\n}\n\nconst { container, button, final, body} = styles\n\n\n"]},"metadata":{},"sourceType":"module"}